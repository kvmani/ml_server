{% extends "base.html" %}
{% block title %}Hydride Segmentation{% endblock %}
{% block content %}
<h1 class="mb-4">Hydride Segmentation</h1>
<form method="post" enctype="multipart/form-data">
  <div class="mb-3">
    <label class="form-label" for="image">Image</label>
    <input type="file" class="form-control" id="image" name="image" accept="image/*" required>
  </div>
  <div class="mb-3">
    <label class="form-label" for="algorithm">Algorithm</label>
    <select class="form-select" id="algorithm" name="algorithm">
      <option value="ml">ML</option>
      <option value="conventional">Conventional</option>
    </select>
  </div>
  <div id="conv-params" style="display:none;">
    <div class="mb-3">
      <label class="form-label" for="area_threshold">Area Threshold</label>
      <input class="form-control" type="number" id="area_threshold" name="area_threshold" value="95">
    </div>
    <div class="mb-3">
      <label class="form-label" for="tile_size">Tile Size</label>
      <input class="form-control" type="number" id="tile_size" name="tile_size" value="8">
    </div>
  </div>
  {% if error %}<div class="alert alert-danger">{{ error }}</div>{% endif %}
  <button class="btn btn-primary" type="submit">Run Segmentation</button>
</form>
<script nonce="{{ csp_nonce() }}">
(function() {
  const sel = document.getElementById('algorithm');
  const params = document.getElementById('conv-params');
  function toggle() { params.style.display = sel.value === 'conventional' ? 'block' : 'none'; }
  sel.addEventListener('change', toggle);
  toggle();
})();
</script>
{% endblock %}
